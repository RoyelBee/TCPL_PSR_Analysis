
# # PSR ID, Name, ReportingBoss, Yearmonth, TargetValues, TargetQty, Brand

select A.SRID, SRSNAME as SRName, ASENAME as 'ReportingBoss', B.SKUID ,
ShortName as SKUName,  B.Brand as Brand, TargetVal , TargetQty
from

(select SRID, SRSNAME, ASENAME  from Hierarchy_EMP) as A
left join

(select SRID, TargetDistributionItemBySR.SKUID as SKUID , ShortName,  count(Hierarchy_SKU.BrandID) as Brand,
 sum(TargetValue) as [TargetVal] , sum(TargetQty) as [TargetQty]
from TargetDistributionItemBySR

join Hierarchy_SKU
on TargetDistributionItemBySR.SKUID = Hierarchy_SKU.SKUID
group by SRID, TargetDistributionItemBySR.SKUID, ShortName) as B


on A.SRID = B.SRID
where A.SRID = '22'



# # --------- SR brand wise sales ---------------------------------

select a.srid,b.SRNAME,sum(Quantity*InvoicePrice) as sale,brandname from
(select item.*,SRID from
(select * from SalesInvoices where InvoiceDate>='1 aug 2020') as Sales
inner join
(
select * from SalesInvoiceItem) as item
on sales.invoiceid=item.invoiceid) as a

left join
(select * from Hierarchy_SKU) as SKu
on a.skuid=sku.skuid
left join
(select * from Hierarchy_Emp) as b
on a.srid=b.srid
where a.srid=22
group by b.SRNAME,brandname,a.srid

